<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GÃ¼nlÃ¼k Takip ProgramÄ±</title>
    <style>
        body { font-family: Arial, sans-serif; background: linear-gradient(135deg,#e8f5e9,#f4f6f8); padding:20px; transition: background 0.3s; }
        body.dark { background: #121212; color: #eaeaea; }
        .container { max-width:900px; margin:auto; background:#ffffff; padding:18px; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,0.08); }
        body.dark .container { background: #1e1e1e; color: #fff; }
        
        .weekdays { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; margin-top: 10px; font-weight: bold; text-align: center; color: #555; }
        #monthDays { display:grid; grid-template-columns:repeat(7,1fr); gap:6px; margin-top:10px; }
        #monthDays button { position:relative; border:1px solid #ddd; border-radius:10px; background:#fafafa; padding:8px 0; cursor:pointer; }
        #monthDays button.active { background:#c8e6c9; border-color:#66bb6a; }
        
        .task-grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(150px, 1fr)); gap:10px; margin-top:15px; }
        .task-card { border:1px solid #ddd; border-radius:12px; padding:15px; background:#fafafa; cursor:pointer; transition: 0.2s; }
        .task-card.completed { background:#e8f5e9; border-color:#66bb6a; text-decoration:line-through; color:gray; }
        .task-card.delete-hold { background:#ffebee !important; border-color:#e53935 !important; }

        .day-dot { width:6px; height:6px; border-radius:50%; margin:2px auto 0; background:#ccc; }
        .dot-has { background:#ffd54f; }
        .dot-done { background:#81c784; }
        
        input, button { padding:10px; border-radius:8px; border:1px solid #ddd; }
        button { cursor:pointer; }
        #darkToggle { float: right; }
    </style>
</head>
<body>

<div class="container">
    <button id="darkToggle">ðŸŒ™</button>
    <h1>ðŸ“‹ GÃ¼nlÃ¼k Takip</h1>
    
    <label>Ay / YÄ±l SeÃ§:</label>
    <input type="month" id="monthInput">
    <button id="toggleMulti">âž• Ã‡oklu SeÃ§im</button>
    <button id="clearSelected" style="background:#ffdddd;">ðŸ§¹ Temizle</button>

    <div id="dayCounter" style="margin:10px 0; font-weight:bold;">
        <span style="color:#2e7d32;">ðŸŸ¢ Biten: <span id="doneCount">0</span></span> | 
        <span style="color:#f9a825;">ðŸŸ¡ Kalan: <span id="pendingCount">0</span></span>
    </div>

    <div class="weekdays">
        <div>Pt</div><div>Sl</div><div>Ã‡r</div><div>Pr</div><div>Cm</div><div>Ct</div><div>Pz</div>
    </div>
    <div id="monthDays"></div>

    <hr>
    <input type="text" id="taskInput" placeholder="YapÄ±lacak iÅŸi yaz">
    <button id="addBtn">âž• Ä°ÅŸ Ekle</button>
    <div id="taskGrid" class="task-grid"></div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    let currentDate = null;
    let selectedDays = [];
    let multiSelect = false;

    const monthInput = document.getElementById('monthInput');
    const monthDays = document.getElementById('monthDays');
    const taskGrid = document.getElementById('taskGrid');
    const taskInput = document.getElementById('taskInput');
    const addBtn = document.getElementById('addBtn');

    const getDays = () => JSON.parse(localStorage.getItem('days')) || {};
    const saveDays = (d) => {
        localStorage.setItem('days', JSON.stringify(d));
        updateDayCounter();
        renderMonthDots();
    };

    monthInput.addEventListener('change', renderCalendar);

    function renderCalendar() {
        monthDays.innerHTML = '';
        if (!monthInput.value) return;
        const [y, m] = monthInput.value.split('-').map(Number);
        const firstDay = (new Date(y, m - 1, 1).getDay() + 6) % 7;
        const daysInMonth = new Date(y, m, 0).getDate();

        for (let i = 0; i < firstDay; i++) {
            monthDays.appendChild(document.createElement('div'));
        }

        const daysData = getDays();
        for (let d = 1; d <= daysInMonth; d++) {
            const iso = `${y}-${String(m).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
            const btn = document.createElement('button');
            btn.textContent = d;
            btn.dataset.date = iso;
            
            const dot = document.createElement('div');
            dot.className = 'day-dot';
            if (daysData[iso] && daysData[iso].length > 0) {
                const allDone = daysData[iso].every(t => t.done);
                dot.classList.add(allDone ? 'dot-done' : 'dot-has');
            }

            btn.onclick = () => {
                if (!multiSelect) {
                    selectedDays = [iso];
                    document.querySelectorAll('#monthDays button').forEach(b => b.classList.remove('active'));
                } else {
                    if (selectedDays.includes(iso)) selectedDays = selectedDays.filter(x => x !== iso);
                    else selectedDays.push(iso);
                }
                btn.classList.toggle('active', selectedDays.includes(iso));
                currentDate = iso;
                loadTasks();
            };

            btn.appendChild(dot);
            monthDays.appendChild(btn);
        }
    }

    function loadTasks() {
        taskGrid.innerHTML = '';
        if (!currentDate) return;
        const tasks = getDays()[currentDate] || [];
        tasks.forEach((task, index) => {
            const card = document.createElement('div');
            card.className = `task-card ${task.done ? 'completed' : ''}`;
            card.textContent = task.text;
            
            card.onclick = () => {
                const days = getDays();
                days[currentDate][index].done = !days[currentDate][index].done;
                saveDays(days);
                loadTasks();
            };

            // Silme (BasÄ±lÄ± Tutma)
            let timer;
            card.onmousedown = card.ontouchstart = () => {
                card.classList.add('delete-hold');
                timer = setTimeout(() => {
                    if(confirm('Silinsin mi?')) {
                        const days = getDays();
                        days[currentDate].splice(index, 1);
                        saveDays(days);
                        loadTasks();
                    }
                }, 800);
            };
            card.onmouseup = card.onmouseleave = card.ontouchend = () => {
                clearTimeout(timer);
                card.classList.remove('delete-hold');
            };

            taskGrid.appendChild(card);
        });
    }

    function updateDayCounter() {
        const days = getDays();
        let done = 0, pending = 0;
        for (const date in days) {
            if (days[date].length > 0) {
                if (days[date].every(t => t.done)) done++;
                else pending++;
            }
        }
        document.getElementById('doneCount').textContent = done;
        document.getElementById('pendingCount').textContent = pending;
    }

    function renderMonthDots() {
        const daysData = getDays();
        document.querySelectorAll('#monthDays button[data-date]').forEach(btn => {
            const iso = btn.dataset.date;
            const dot = btn.querySelector('.day-dot');
            dot.className = 'day-dot';
            if (daysData[iso] && daysData[iso].length > 0) {
                dot.classList.add(daysData[iso].every(t => t.done) ? 'dot-done' : 'dot-has');
            }
        });
    }

    addBtn.onclick = () => {
        const val = taskInput.value.trim();
        if (!val || selectedDays.length === 0) return alert('GÃ¼n seÃ§in ve gÃ¶rev yazÄ±n');
        const days = getDays();
        selectedDays.forEach(d => {
            if (!days[d]) days[d] = [];
            days[d].push({ text: val, done: false });
        });
        saveDays(days);
        taskInput.value = '';
        loadTasks();
    };

    // BaÅŸlangÄ±Ã§ AyarlarÄ±
    const now = new Date();
    monthInput.value = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}`;
    renderCalendar();
    updateDayCounter();

    // Dark Mode
    document.getElementById('darkToggle').onclick = () => {
        document.body.classList.toggle('dark');
        localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
    };
});
</script>
</body>
</html>
